version: 2

group: "sinanrio"

macros:
  - name: sinanrio_lista_cids_sintomaticos
    description: >
      Retorna a lista de CIDs usados para identificar possíveis sintomáticos respiratórios nos atendimentos registrados no prontuário. 
      Essa lista é usada para filtrar
      pacientes com suspeita clínica compatível com tuberculose ou condições respiratórias afins.
    arguments: []
    meta:
      returns: "ARRAY<STRING>"
      uso_exemplo: |
        -- Ex.: filtrar atendimentos
        where cid_principal in ({{ sinanrio_lista_cids_sintomaticos() | join(",") }})

  - name: sinanrio_padronize_sexo
    description: |
      Padroniza sexo para códigos numéricos:
        • 1 = Masculino
        • 2 = Feminino
        • 3 = Ignorado/Indefinido
      Aceita variações comuns (`'M','F','MASCULINO','FEMININO','1','2','I','IGN','INDEFINIDO'`), insensível a acentos/caixa.
    arguments:
      - name: coluna
        type: string
        description: "Expressão/coluna de origem (STRING)."
    meta:
      returns: "INT64 (1/2/3)"
      nulos: "Retorna NULL quando o valor não for reconhecido."
      uso_exemplo: |
        select {{ sinanrio_padronize_sexo('sexo') }} as id_sexo from tabela

  - name: sinanrio_padronize_raca_cor
    description: |
      Padroniza raça/cor para códigos numéricos (SINAN):
        • 1 = Branca
        • 2 = Preta
        • 3 = Parda
        • 4 = Amarela
        • 5 = Indígena
        • 9 = Ignorado
      Aceita abreviações/variações (ex.: `'BRNCA','PRTO','PA','IND','IDG'`), insensível a acentos/caixa.
    arguments:
      - name: coluna
        type: string
        description: "Expressão/coluna de origem (STRING)."
    meta:
      returns: "INT64 (1/2/3/4/5/9)"
      nulos: "Retorna NULL quando o valor não for reconhecido."
      uso_exemplo: |
        select {{ sinanrio_padronize_raca_cor('raca') }} as id_raca_cor from tabela