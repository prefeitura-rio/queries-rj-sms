version: 2
models:
  - name: raw_ser_metabase__ambulatorial
    description: Base contendo registros de solicitações para ambulatoriais do SER (Sistema Estadual de Regulação), extraída via API do Metabase disponibilizada pelo Estado.
    columns:
      - name: id_solicitacao
        description: Identificador único da solicitação no SER.
        data_type: int64
        quote: true
        data_tests:
          - unique
          - not_null

      - name: data_solicitacao
        description: Data de criação da solicitação no SER (timezone America/Sao_Paulo).
        data_type: date
        quote: true
        data_tests:
          - not_null

      - name: data_agendamento
        description: Data de agendamento do procedimento/consulta.
        data_type: date
        quote: true

      - name: data_execucao
        description: Data de execução do procedimento/consulta.
        data_type: date
        quote: true

      - name: data_tratamento_inicio
        description: Data de início efetivo do tratamento.
        data_type: date
        quote: true

      - name: data_tratamento_prevista
        description: Data prevista para início do tratamento.
        data_type: date
        quote: true

      - name: data_atualizacao_registro
        description: Data da última atualização do registro no SER.
        data_type: date
        quote: true

      - name: id_cnes_unidade_origem
        description: CNES da unidade solicitante/origem.
        data_type: string
        quote: true

      - name: id_cnes_unidade_executante
        description: CNES da unidade executante.
        data_type: string
        quote: true

      - name: carater
        description: "Caráter do atendimento conforme SER (ex.: URGENCIA, ELETIVA)."
        data_type: string
        quote: true

      - name: classificacao_risco
        description: "Classificação de risco da solicitação ambulatorial (ex.: URGENCIA, PRIORIDADE_NAO_URGENTE, CONSULTA_BAIXA_COMPLEXIDADE, EMERGENCIA)."
        data_type: string
        quote: true

      - name: procedimento_solicitado_tipo
        description: "Tipo do recurso solicitado (ex.: CONSULTA, EXAME)."
        data_type: string
        quote: true

      - name: especialidade_solicitado
        description: Especialidade solicitada (ex. GASTROENTEROLOGIA, PNEUMOLOGIA, CARDIOLOGIA).
        data_type: string
        quote: true

      - name: procedimento_solicitado
        description: Procedimento solicitado.
        data_type: string
        quote: true

      - name: procedimento_regulado_tipo
        description: "Tipo do recurso efetivamente regulado (ex.: CONSULTA, EXAME)."
        data_type: string
        quote: true

      - name: especialidade_regulado
        description: Especialidade efetivamente regulada (ex. GASTROENTEROLOGIA, PNEUMOLOGIA, CARDIOLOGIA).
        data_type: string
        quote: true

      - name: procedimento_regulado
        description: Procedimento regulado.
        data_type: string
        quote: true

      - name: cid
        description: Condição associada ao paciente conforme CID-10.
        data_type: string
        quote: true

      - name: cod_recurso_solicitado
        description: Código do recurso solicitado no SER.
        data_type: string
        quote: true

      - name: cod_recurso_regulado
        description: Código do recurso regulado no SER.
        data_type: string
        quote: true

      - name: solicitacao_estado
        description: "Estado atual da solicitação no SER (ex.: CHEGADA_CONFIRMADA, REGULADO, ALTA, CANCELADA)."
        data_type: string
        quote: true

      - name: prioridade
        description: Prioridade atribuída à solicitação.
        data_type: string
        quote: true

      - name: justificativa_cancelamento
        description: Justificativa do cancelamento da solicitação, quando houver.
        data_type: string
        quote: true

      - name: paciente_cns
        description: Cartão Nacional de Saúde do paciente (CNS).
        data_type: string
        quote: true
        policy_tags:
          - '{{ var ("TAG_CNS") }}'

      - name: paciente_nome
        description: Nome do paciente.
        data_type: string
        quote: true
        policy_tags:
          - '{{ var ("TAG_NOME") }}'

      - name: paciente_municipio
        description: Município de residência do paciente.
        data_type: string
        quote: true

      - name: paciente_sexo
        description: Sexo do paciente.
        data_type: string
        quote: true

      - name: paciente_data_nascimento
        description: Data de nascimento do paciente.
        data_type: date
        quote: true
        policy_tags:
          - '{{ var ("TAG_DATA_NASCIMENTO") }}'

      - name: indicador_apto_tratamento
        description: Indicador se o paciente está apto para o tratamento.
        data_type: string
        quote: true

      - name: jud_acao_judicial_id
        description: Número identificador da ação judicial associada à solicitação, quando aplicável.
        data_type: string
        quote: true

      - name: jud_juiz_nome
        description: Nome do juiz associado à ação judicial, quando aplicável.
        data_type: string
        quote: true

      - name: jud_decisao_juiz
        description: Decisão do juiz associada à solicitação, quando aplicável.
        data_type: string
        quote: true

      - name: jud_pena
        description: Pena associada à decisão judicial, quando aplicável.
        data_type: string
        quote: true

      - name: jud_reu
        description: Réu associado à ação judicial, quando aplicável.
        data_type: string
        quote: true

      - name: mandado_judicial
        description: Indicador do mandado.
        data_type: string
        quote: true

      - name: jud_prazo
        description: Prazo definido em decisão judicial.
        data_type: string
        quote: true

      - name: data_extracao
        description: Timestamp de extração via API do Metabase do SER.
        data_type: timestamp
        quote: true

  - name: raw_ser_metabase__internacoes
    description: Base contendo registros de internações do SER (Sistema Estadual de Regulação), extraída via API do Metabase disponibilizada pelo Estado.
    columns:
      - name: id_solicitacao
        description: Identificador único da solicitação no SER.
        data_type: int64
        quote: true
        data_tests:
          - unique
          - not_null

      - name: data_solicitacao
        description: Data de criação da solicitação no SER (timezone America/Sao_Paulo).
        data_type: date
        quote: true
        data_tests:
          - not_null

      - name: data_reserva
        description: Data da reserva de leito.
        data_type: date
        quote: true

      - name: data_internacao_inicio
        description: Data de início da internação.
        data_type: date
        quote: true

      - name: data_internacao_termino
        description: Data de término da internação.
        data_type: date
        quote: true

      - name: data_alta
        description: Data de alta hospitalar.
        data_type: date
        quote: true

      - name: data_atualizacao_registro
        description: Data da última atualização do registro no SER.
        data_type: date
        quote: true

      - name: id_cnes_unidade_origem
        description: CNES da unidade solicitante/origem.
        data_type: string
        quote: true

      - name: id_cnes_unidade_executante
        description: CNES da unidade executante.
        data_type: string
        quote: true

      - name: carater
        description: "Caráter da internação conforme SER (ex.: URGENCIA, ELETIVA)."
        data_type: string
        quote: true

      - name: procedimento_tipo
        description: "Tipo do procedimento (INTERNACAO)."
        data_type: string
        quote: true

      - name: procedimento_especialidade
        description: Especialidade do procedimento (ex. CLÍNICA GERAL, CARDIOLOGIA, OBSTETRICIA CLINICA, OFTALMOLOGIA).
        data_type: string
        quote: true

      - name: procedimento
        description: Procedimento regulado/executado
        data_type: string
        quote: true

      - name: procedimento_leito_solicitado_tipo
        description: Tipo de leito solicitado (ex. UTI NEONATAL (PUBLICA), CLÍNICO, UTI PEDIÁTRICO, ,HOSPITAL-DIA, , OBSTÉTRICOS, CIRÚRGICO).
        data_type: string
        quote: true

      - name: procedimento_leito_regulado_tipo
        description: Tipo de leito regulado (ex. UTI NEONATAL (PUBLICA), CLÍNICO, UTI PEDIÁTRICO, ,HOSPITAL-DIA, , OBSTÉTRICOS, CIRÚRGICO).
        data_type: string
        quote: true

      - name: cid
        description: Condição associada ao paciente conforme CID-10.
        data_type: string
        quote: true

      - name: internacao_tipo
        description: "Tipo de ingresso na internação (NA_PROPRIA, TRANSFERENCIA ou INGRESSO)."
        data_type: string
        quote: true

      - name: solicitacao_estado
        description: "Estado atual da solicitação no SER (ex.: REGULADO, ALTA, CANCELADA)."
        data_type: string
        quote: true

      - name: solicitacao_estado_atual
        description: Estado atual calculado/mais recente da solicitação no SER.
        data_type: string
        quote: true

      - name: solicitacao_estado_anterior
        description: Estado imediatamente anterior da solicitação no SER.
        data_type: string
        quote: true

      - name: justificativa_alta
        description: Motivo da alta (ex. OBITO, ALTA_MELHORADO, ALTA_PREVISAO_RETORNO, ALTA_HOSPITALAR).
        data_type: string
        quote: true

      - name: justificativa_cancelamento
        description: Justificativa do cancelamento da solicitação, quando houver.
        data_type: string
        quote: true

      - name: paciente_cns
        description: Cartão Nacional de Saúde do paciente (CNS).
        data_type: string
        quote: true
        policy_tags:
          - '{{ var ("TAG_CNS") }}'

      - name: paciente_nome
        description: Nome do paciente.
        data_type: string
        quote: true
        policy_tags:
          - '{{ var ("TAG_NOME") }}'

      - name: paciente_data_nascimento
        description: Data de nascimento do paciente.
        data_type: date
        quote: true
        policy_tags:
          - '{{ var ("TAG_DATA_NASCIMENTO") }}'

      - name: id_paciente_municipio_ibge
        description: Código IBGE do município de residência do paciente.
        data_type: int64
        quote: true

      - name: indicador_sala_vermelha
        description: Indicador de encaminhamento/atendimento em Sala Vermelha.
        data_type: string
        quote: true

      - name: indicador_infarto_agudo
        description: Indicador de infarto agudo.
        data_type: string
        quote: true

      - name: indicador_infarto_agudo_supra_st
        description: Indicador de infarto agudo com supra de ST.
        data_type: string
        quote: true

      - name: indicador_infarto_agudo_trombolizado
        description: Indicador de trombólise realizada em contexto de infarto agudo.
        data_type: string
        quote: true

      - name: jud_juiz_nome
        description: Nome do juiz associado à ação judicial, quando aplicável.
        data_type: string
        quote: true

      - name: jud_acao_judicial_id
        description: Número identificador da ação judicial associada à solicitação, quando aplicável.
        data_type: string
        quote: true

      - name: jud_pena
        description: Pena associada à decisão judicial, quando aplicável.
        data_type: string
        quote: true

      - name: jud_decisao_juiz
        description: Decisão do juiz associada à solicitação, quando aplicável.
        data_type: string
        quote: true

      - name: jud_prazo
        description: Prazo definido em decisão judicial, quando aplicável.
        data_type: string
        quote: true

      - name: jud_reu
        description: Réu associado à ação judicial, quando aplicável.
        data_type: string
        quote: true

      - name: id_operacao_internacao
        description: Identificador da operação de internação.
        data_type: string
        quote: true

      - name: observacao
        description: Observações registradas no SER.
        data_type: string
        quote: true

      - name: data_extracao
        description: Timestamp de extração via API do Metabase do SER.
        data_type: timestamp
        quote: true
