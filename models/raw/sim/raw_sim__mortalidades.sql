{{
    config(
        alias="mortalidades",
        materialized="table",
    )
}}

SELECT
  to_hex(sha256(cast({{ process_null("NUMERODO") }} as string))) as id_hash,
  {{ process_null("NUMERODO") }} as id_declaracao_obito,
  {{ process_null("NUMERODV") }} as numero_dv,
  {{ process_null("CODESTCART") }} as codigo_estab_cartorio,
  {{ process_null("CODMUNCART") }} as codigo_municipio_cartorio,
  {{ process_null("CODCART") }} as codigo_cartorio,
  {{ process_null("NUMREGCART") }} as numero_registro_cartorio,
  {{ parse_date(process_null("DTREGCART")) }} as data_registro_cartorio,
  {{ process_null("TIPOBITO") }} as tipo_obito,
  {{ parse_date(process_null("DTOBITO")) }} as data_obito,
  {{ parse_time(process_null("HORAOBITO")) }} as hora_obito,
  {{ process_null("NUMSUS") }} as numero_sus,
  {{ process_null("`NATURAL`") }} as naturalidade,
  {{ process_null("CODMUNNATU") }} as codigo_municipio_natural,
  {{ process_null("NOME") }} as nome,
  {{ process_null("NOMEPAI") }} as nome_pai,
  {{ process_null("NOMEMAE") }} as nome_mae,
  {{ parse_date(process_null("DTNASC")) }} as data_nascimento,
  {{ process_null("IDADE") }} as idade,
  {{ process_null("SEXO") }} as sexo,
  {{ process_null("RACACOR") }} as raca_cor,
  {{ process_null("ESTCIV") }} as estado_civil,
  {{ process_null("ESC") }} as esc,
  {{ process_null("ESC2010") }} as esc_2010,
  {{ process_null("SERIESCFAL") }} as seri_esc_fal,
  {{ process_null("OCUP") }} as ocupacao,
  {{ process_null("CODESTRES") }} as codigo_estab_residencia,
  {{ process_null("CODMUNRES") }} as codigo_municipio_residencia,
  {{ process_null("BAIRES") }} as bairro_residencia,
  {{ process_null("CODBAIRES") }} as codigo_bairro_residencia,
  {{ process_null("CODENDRES") }} as codigo_endereco_residencia,
  {{ process_null("ENDRES") }} as endereco_residencia,
  {{ process_null("CODREGRES") }} as codigo_registro_residencia,
  {{ process_null("NUMRES") }} as numero_residencia,
  {{ process_null("COMPLRES") }} as complemento_residencia,
  {{ process_null("CEPRES") }} as cep_residencia,
  {{ process_null("CODDISRES") }} as codigo_distrito_residencia,
  {{ process_null("CODPAISRES") }} as codigo_pais_residencia,
  {{ process_null("LOCOCOR") }} as local_ocorrencia,
  {{ process_null("CODESTAB") }} as codigo_estab,
  {{ process_null("CODESTOCOR") }} as codigo_estab_ocorrencia,
  {{ process_null("CODMUNOCOR") }} as codigo_municipio_ocorrencia,
  {{ process_null("BAIOCOR") }} as bairro_ocorrencia,
  {{ process_null("CODBAIOCOR") }} as codigo_bairro_ocorrencia,
  {{ process_null("ENDOCOR") }} as endereco_ocorrencia,
  {{ process_null("CODENDOCOR") }} as codigo_endereco_ocorrencia,
  {{ process_null("CODREGOCOR") }} as codigo_registro_ocorrencia,
  {{ process_null("NUMENDOCOR") }} as numero_endereco_ocorrencia,
  {{ process_null("COMPLOCOR") }} as complemento_ocorrencia,
  {{ process_null("CEPOCOR") }} as cep_ocorrencia,
  {{ process_null("CODDISOCOR") }} as codigo_distrito_ocorrencia,
  {{ process_null("IDADEMAE") }} as idade_mae,
  {{ process_null("ESCMAE") }} as esc_mae,
  {{ process_null("ESCMAE2010") }} as esc_mae_2010,
  {{ process_null("SERIESCMAE") }} as serie_esc_mae,
  {{ process_null("OCUPMAE") }} as ocupacao_mae,
  {{ process_null("QTDFILVIVO") }} as qtd_filho_vivo,
  {{ process_null("QTDFILMORT") }} as qtd_filho_morto,
  {{ process_null("GRAVIDEZ") }} as gravidez,
  {{ process_null("SEMAGESTAC") }} as semana_gestacao,
  {{ process_null("GESTACAO") }} as gestacao,
  {{ process_null("PARTO") }} as parto,
  {{ process_null("OBITOPARTO") }} as obito_parto,
  {{ process_null("PESO") }} as peso,
  {{ process_null("NUMERODN") }} as numero_do_nascimento,
  {{ process_null("TPMORTEOCO") }} as tipo_obito_co,
  {{ process_null("OBITOGRAV") }} as obito_gravidez,
  {{ process_null("OBITOPUERP") }} as obito_puerperio,
  {{ process_null("ASSISTMED") }} as assistencia_medica,
  {{ process_null("EXAME") }} as exame,
  {{ process_null("CIRURGIA") }} as cirurgia,
  {{ process_null("NECROPSIA") }} as necropsia,
  {{ process_null("LINHAA") }} as linha_a,
  {{ process_null("LINHAB") }} as linha_b,
  {{ process_null("LINHAC") }} as linha_c,
  {{ process_null("LINHAD") }} as linha_d,
  {{ process_null("LINHAII") }} as linha_ii,
  {{ process_null("DSTEMPO") }} as ds_tempo,
  {{ process_null("CAUSABAS") }} as causa_bas,
  {{ process_null("DSEXPLICA") }} as ds_explica,
  {{ process_null("MEDICO") }} as medico,
  {{ process_null("CRM") }} as crm,
  {{ process_null("TPASSINA") }} as tpassina,
  {{ process_null("COMUNSVOIM") }} as comun_voim,
  {{ process_null("CONTATO") }} as contato,
  {{ parse_date(process_null("DTATESTADO")) }} as dt_atestado,
  {{ process_null("CIRCOBITO") }} as circustancia_obito,
  {{ process_null("ACIDTRAB") }} as acidente_de_trabalho,
  {{ process_null("FONTE") }} as fonte,
  {{ process_null("DSEVENTO") }} as ds_evento,
  {{ process_null("ENDACID") }} as endereco_acidente,
  {{ process_null("NUMEROLOTE") }} as numero_lote,
  {{ process_null("TPPOS") }} as tp_pos,
  {{ parse_date(process_null("DTINVESTIG")) }} as dt_investigacao,
  {{ process_null("LINHAA_O") }} as linha_a_o,
  {{ process_null("LINHAB_O") }} as linha_b_o,
  {{ process_null("LINHAC_O") }} as linha_c_o,
  {{ process_null("LINHAD_O") }} as linha_d_o,
  {{ process_null("LINHAII_O") }} as linha_ii_o,
  {{ process_null("CAUSABAS_O") }} as causa_bas_o,
  {{ parse_date(process_null("DTCADASTRO")) }} as dt_cadastro,
  {{ process_null("ATESTANTE") }} as atestante,
  {{ process_null("DESCACID") }} as desc_acidente,
  {{ process_null("CODENDACID") }} as cod_end_acidente,
  {{ process_null("NUMENDACID") }} as num_end_acidente,
  {{ process_null("COMPLACID") }} as complemento_acidente,
  {{ process_null("CEPACID") }} as cep_acidente,
  {{ process_null("CONFPESO") }} as conf_peso,
  {{ process_null("CONFIDADE") }} as conf_idade,
  {{ process_null("CONFCAUSA") }} as conf_causa,
  {{ process_null("CONFCIDADE") }} as conf_cidade,
  {{ process_null("CRITICA") }} as critica,
  {{ process_null("CODINST") }} as cod_inst,
  {{ process_null("STCODIFICA") }} as st_codifica,
  {{ process_null("CODIFICADO") }} as codificado,
  {{ process_null("VERSAOSIST") }} as versao_sist,
  {{ process_null("VERSAOSCB") }} as versao_scb,
  {{ process_null("RETROALIM") }} as retro_alim,
  {{ process_null("FONTEINV") }} as fonte_investigacao,
  {{ parse_date(process_null("DTRECEBIM")) }} as dt_recebimento,
  {{ process_null("ATESTADO") }} as atestado,
  {{ process_null("CAUSABAS_R") }} as causa_bas_r,
  {{ parse_date(process_null("DTRESSELE")) }} as dt_ressele,
  {{ process_null("STRESSELE") }} as st_ressele,
  {{ process_null("EXPLICA_R") }} as explica_r,
  {{ process_null("VRSRESSELE") }} as vrs_ressele,
  {{ process_null("COMPARA_CB") }} as compara_cb,
  {{ process_null("NRESSELE") }} as n_ressele,
  {{ process_null("CB_PRE") }} as cb_pre,
  {{ process_null("NPROC") }} as n_proc,
  {{ process_null("DIFDATA") }} as dif_data,
  {{ process_null("VERSCBPRE") }} as versao_cb_pre,
  {{ parse_date(process_null("DTRECORIG")) }} as dt_recorrigido,
  {{ process_null("CAUSAMAT") }} as causa_mat,
  {{ process_null("ESCMAEAGR1") }} as esc_mae_agr1,
  {{ process_null("ESCMAEAGR2") }} as esc_mae_agr2,
  {{ process_null("ESCFALAGR1") }} as esc_fal_agr1,
  {{ process_null("ESCFALAGR2") }} as esc_fal_agr2,
  {{ process_null("STDOEPIDEM") }} as st_do_epidem,
  {{ process_null("STDONOVA") }} as st_nova,
  {{ process_null("ano") }} as ano_referencia
FROM {{ source("brutos_sim_staging", "sim_2014_2024") }}